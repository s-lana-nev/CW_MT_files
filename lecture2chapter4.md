# Теория трансляции
## Метод операторного предшествования


Этот метод относится к ***восходящим*** (метод снизу вверх), которые  начинают разбор с конечных узлов грамматического дерева и пытаются объединить их построением узлов все более и более высокого уровня до тех пор, пока не будет достигнут ,корень дерева. Метод операторного предшествования основан на анализе пар последовательно расположенных операторов исходной программы и решением вопроса о том, какой из них должен выполняться первым.

Рассмотрим, например, арифметическое выражение *А + В\*С-В*.  


В соответствии с обычными правилами арифметики умножение и деление осуществляются до сложения и вычитания. Можно сказать, что умножение и деление имеют более высокий уровень предшествования, чем сложение и вычитание. При анализе первых двух операторов (+,*), выяснится, что оператор + имеет более низкий уровень предшествования, чем оператор *. 

Часто это записывают следующим образом: + <•*

Аналогично для следующей пары операторов (\* и -) оператор \* имеет более высокий уровень предшествования, чем оператор -. 

Мы можем записать это в виде \*•>-

Метод операторного предшествования использует подобные отношения между операторами для управления процесса грамматического разбора. 

В частности, для рассмотренного арифметического выражения мы получили следующие отношения предшествования:  
А+ В\*С –В  
<•.......•>

Отсюда следует, что подвыражение В\*С должно быть вычислено до обработки любых других операторов рассматриваемого выражения. В терминах дерева грамматического разбора это означает, что операция * расположена на более низком уровне узлов дерева, чем операция + или -. Таким образом, рассматриваемый метод грамматического разбора должен распознать конструкцию В\*С, интерпретируя ее в терминах заданной грамматики, до анализа соседних термов предложения.

Предшествующее изложение иллюстрирует основную идею, на которой основан метод грамматического разбора, построенный на отношения операторного предшествования. В рамках этого метода предложение сканируется слева направо до тех пор, пока не будет найдено подвыражение, операторы которого имеют более высокий уровень предшествования, чем соседние операторы. Далее это подвыражение распознается в терминах правил вывода используемой грамматики. Этот процесс, продолжается до тех пор, пока не будет достигнут корень дерева, что и будет означать окончание процесса грамматического разбора. Далее мы рассмотрим приложение описанного подхода к следующему примеру программы:

```pascal
if i MOD 2 = 0 THEN Z := Z * X ;
i := i DIV 2 ;
X := X * X * X
```

Грамматика этого предложения имеет вид, представленный на схеме ниже.

|  if | MOD | THEN| DIV |  =  | :=  |  *  |  ;  |  id |const|
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
|     |   < |   = |     |   < |     |     |     |   < |   < |
|     |   = |     |   = |   > |     |   = |     |   < |   < |
|   < |     |     |     |     |     |     |     |   < |   < |
|     |   = |     |   = |   > |     |   = |     |   < |   < |
|   > |     |   > |     |     |     |     |     |   < |   < |
|     |   < |     |   < |     |     |   < |   > |   < |   < |
|     |   = |     |   = |   > |     |   = |     |   < |   < |
|   < |     |     |     |     |     |     |   = |   < |     |
|     |   > |     |   > |   > |   = |   > |   > |     |     |
|   > |   > |   > |   > |   > |     |   > |   > |     |     |

Первым шагом при разработке процессора грамматического разбора, основанного на методе операторного предшествования, должно быть установление отношений предшествования между операторами грамматиками. При этом под оператором понимается любой терминальный символ (т.е. любая лексема). Таким образом, мы должны, в частности, установить отношения предшествования между лексемами. 
Каждая клетка этой матрицы определяет отношение предшествования (если оно существует) между лексемами, соответствующими строке и столбцу, на пересечении которых находится эта клетка. 

Обратите внимание также на то, что для многих пар лексем отношения предшествования не существует. Это означает, что соответствующие пары лексем не могут находиться рядом ни в каком грамматически пра¬вильном предложении. Если подобная комбинация лексем все же встретится в процессе грамматического разбора, то она должна рассматриваться как синтаксическая ошибка.

Заметим еще раз, что процесс грамматического разбора начинается слева направо и продолжается на каждом шаге до тех пор, пока не определится очередной фрагмент предложения для грамматического распознава¬ния, т.е. первый фрагмент, ограниченный отношениями <• и •>. Как только подобный фрагмент выделен, он интерпретируется как некоторый очередной нетерминальный символ в соответствии с каким-нибудь правилом грамматики. Этот процесс продолжается до тех пор, пока предложение не будет распознано целиком.

Обратите внимание, что каждый фрагмент дерева грамматического разбора строится, начиная с конечных узлов вверх, в сторону корня дерева. Отсюда и возник термин восходящий разбор.

Возможный алгоритм метода операторного предшествования приведен на РИСУНКЕ ОТРИСОВАТЬ.
